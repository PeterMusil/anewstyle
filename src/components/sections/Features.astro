---
import Palette from "../palette/Palette.astro";
import { useTranslations, type Lang } from "../../i18n/utils";

interface Props {
  id: string;
  lang?: Lang;
}

const { id, lang = "cs" } = Astro.props as Props;
const t = useTranslations(lang);

const toHtmlBreaks = (value: string): string =>
  value.replaceAll("\n", "<br />");
const toAltText = (value: string): string => value.replaceAll("\n", " ");
---

<section id={id} class="dark">
  <div class="container container--s">
    <h2 class="title title--white text-center">{t("features.title")}</h2>
    <div class="piktogram">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Ligthweight.svg"
            alt={toAltText(t("features.iconLightweight"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconLightweight"))} />
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item1Desc1")}</span>
          <strong>{t("features.item1Desc2")}</strong>
          <span>{t("features.item1Desc3")}</span>
          <strong>{t("features.item1Desc4")}</strong>
        </p>
      </div>
    </div>
    <div class="piktogram piktogram--invert" id="quick-mounting">
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item2Desc1")}</span>
          <strong>{t("features.item2Desc2")}</strong>
          <span>{t("features.item2Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Mounting.svg"
            alt={toAltText(t("features.iconMounting"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconMounting"))} />
        </div>
      </div>
    </div>
    <div class="piktogram" id="backlight">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Backlight.svg"
            alt={toAltText(t("features.iconBacklight"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconBacklight"))} />
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item3Desc1")}</span>
          <strong>{t("features.item3Desc2")}</strong>
          <span>{t("features.item3Desc3")}</span>
        </p>
      </div>
    </div>
    <div class="piktogram piktogram--invert piktogram--hidden" id="rf-control">
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item4Desc1")}</span>
          <strong>{t("features.item4Desc2")}</strong>
          <span>{t("features.item4Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/RF_control.svg"
            alt={toAltText(t("features.iconRfWireless"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconRfWireless"))} />
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="smartphone-control">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/MobileControl.svg"
            alt={toAltText(t("features.iconSmartphone"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconSmartphone"))} />
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item5Desc1")}</span>
          <strong>{t("features.item5Desc2")}</strong>
          <span>{t("features.item5Desc3")}</span>
        </p>
      </div>
    </div>
    <div
      class="piktogram piktogram--invert piktogram--hidden"
      id="touch-control"
    >
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item15Desc1")}</span>
          <strong>{t("features.item15Desc2")}</strong>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/touch.svg"
            alt={toAltText(t("features.iconTouch"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconTouch"))} />
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="temperature">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/temperature.png"
            alt={t("features.iconTemperature")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconTemperature")}</small>
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item16Desc1")}</span>
          <strong>{t("features.item16Desc2")}</strong>
          <span>{t("features.item16Desc3")}</span>
        </p>
      </div>
    </div>
    <div
      class="piktogram piktogram--invert piktogram--hidden"
      id="thickness-16mm"
    >
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item6Desc1")}</span>
          <strong>{t("features.item6Desc2")}</strong>
          <span>{t("features.item6Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/16mm.svg"
            alt={t("features.iconThickness16")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconThickness16")}</small>
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="thickness-34mm">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/34mm.svg"
            alt={t("features.iconThickness34")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconThickness34")}</small>
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item7Desc1")}</span>
          <strong>{t("features.item7Desc2")}</strong>
          <span>{t("features.item7Desc3")}</span>
        </p>
      </div>
    </div>
    <div class="piktogram piktogram--invert piktogram--hidden" id="laminated">
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item8Desc1")}</span>
          <strong>{t("features.item8Desc2")}</strong>
          <span>{t("features.item8Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/laminated.svg"
            alt={t("features.iconLaminated")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconLaminated")}</small>
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="custom-size">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/CustomSize.svg"
            alt={toAltText(t("features.iconCustomSize"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconCustomSize"))} />
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item9Desc1")}</span>
          <strong>{t("features.item9Desc2")}</strong>
          <span>{t("features.item9Desc3")}</span>
        </p>
      </div>
    </div>
    <div class="piktogram piktogram--invert piktogram--hidden">
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item10Desc1")}</span>
          <strong>{t("features.item10Desc2")}</strong>
          <span>{t("features.item10Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/LED.svg"
            alt={t("features.iconLed")}
            height="75px"
            loading="lazy"
          />
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="dimmable">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Dimmable.svg"
            alt={t("features.iconDimmable")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconDimmable")}</small>
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <strong>{t("features.item11Desc1")}</strong>
          <span>{t("features.item11Desc2")}</span>
        </p>
      </div>
    </div>
    <div
      class="piktogram piktogram--invert piktogram--hidden"
      id="nano-impregnation"
    >
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item12Desc1")}</span>
          <strong>{t("features.item12Desc2")}</strong>
          <span>{t("features.item12Desc3")}</span><b></b>
          <i>{t("features.item12Desc4")}</i>
        </p>
      </div>
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Waterproof.svg"
            alt={toAltText(t("features.iconWaterResistant"))}
            height="75px"
            loading="lazy"
          />
          <small set:html={toHtmlBreaks(t("features.iconWaterResistant"))} />
        </div>
      </div>
    </div>
    <div class="piktogram piktogram--hidden" id="easy-repair">
      <div class="piktogram__box">
        <div class="piktogram__circle">
          <img
            src="/images/symbols/Repair.svg"
            alt={t("features.iconEasyRepair")}
            height="75px"
            loading="lazy"
          />
          <small>{t("features.iconEasyRepair")}</small>
        </div>
      </div>
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item13Desc1")}</span>
          <strong>{t("features.item13Desc2")}</strong>
          <span>{t("features.item13Desc3")}</span>
        </p>
      </div>
    </div>
    <div
      class="piktogram piktogram--invert piktogram--hidden"
      id="color-palette"
    >
      <div class="piktogram__desc">
        <p class="desc">
          <span>{t("features.item14Desc1")}</span>
          <strong>{t("features.item14Desc2")}</strong>
          <span>{t("features.item14Desc3")}</span>
        </p>
      </div>
      <div class="piktogram__box"><Palette lang={lang} /></div>
    </div>
    <div class="text-center">
      <button class="button" id="piktogramsBtn" type="button">
        <span data-variant="more">{t("features.btnMore")}</span>
        <span data-variant="less">{t("features.btnLess")}</span>
      </button>
    </div>
  </div>
</section>

<style>
  #piktogramsBtn span[data-variant="less"] {
    display: none;
  }

  #piktogramsBtn.show-less span[data-variant="more"] {
    display: none;
  }

  #piktogramsBtn.show-less span[data-variant="less"] {
    display: inline;
  }
</style>

<script>
  const piktogramsBtn = document.getElementById(
    "piktogramsBtn"
  ) as HTMLButtonElement;
  const hiddenPiktogtams = document.querySelectorAll(
    ".piktogram--hidden"
  ) as NodeListOf<HTMLDivElement>;
  const productFeatures = document.querySelectorAll(
    ".price-list__features > li > a"
  ) as NodeListOf<HTMLAnchorElement>;

  const handlePictogramsVisbility = (init: boolean) => {
    piktogramsBtn &&
      hiddenPiktogtams.forEach((piktogtam) => {
        !init && piktogtam.classList.toggle("visible");
        piktogtam.classList.contains("visible")
          ? piktogramsBtn.classList.add("show-less")
          : piktogramsBtn.classList.remove("show-less");
      });
  };

  handlePictogramsVisbility(true);

  piktogramsBtn &&
    hiddenPiktogtams &&
    piktogramsBtn.addEventListener("click", () => {
      handlePictogramsVisbility(false);
    });

  productFeatures.forEach((feature) => {
    feature.addEventListener("click", () => {
      hiddenPiktogtams.forEach((piktogtam) => {
        piktogtam.classList.add("visible");
      });
      piktogramsBtn.classList.add("show-less");
    });
  });
</script>
